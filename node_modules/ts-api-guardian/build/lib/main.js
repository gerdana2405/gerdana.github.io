"use strict";
var diff_1 = require('diff');
var fs = require('fs');
var path = require('path');
var serializer_1 = require('./serializer');
var serializer_2 = require('./serializer');
exports.publicApi = serializer_2.publicApi;
function generateGoldenFile(entrypoint, outFile, options) {
    if (options === void 0) { options = {}; }
    var output = serializer_1.publicApi(entrypoint, options);
    ensureDirectory(path.dirname(outFile));
    fs.writeFileSync(outFile, output);
}
exports.generateGoldenFile = generateGoldenFile;
function verifyAgainstGoldenFile(entrypoint, goldenFile, options) {
    if (options === void 0) { options = {}; }
    var actual = serializer_1.publicApi(entrypoint, options);
    var expected = fs.readFileSync(goldenFile).toString();
    if (actual === expected) {
        return '';
    }
    else {
        var patch = diff_1.createPatch(goldenFile, expected, actual, 'Golden file', 'Generated API');
        // Remove the header of the patch
        var start = patch.indexOf('\n', patch.indexOf('\n') + 1) + 1;
        return patch.substring(start);
    }
}
exports.verifyAgainstGoldenFile = verifyAgainstGoldenFile;
function ensureDirectory(dir) {
    if (!fs.existsSync(dir)) {
        ensureDirectory(path.dirname(dir));
        fs.mkdirSync(dir);
    }
}

//# sourceMappingURL=main.js.map
